(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{108:function(e,a,t){},110:function(e,a,t){},123:function(e,a,t){},124:function(e,a,t){},125:function(e,a,t){},127:function(e,a,t){},128:function(e,a,t){},130:function(e,a,t){},131:function(e,a,t){"use strict";t.r(a);var n,r=t(0),l=t.n(r),c=t(41),o=t.n(c),s=(t(68),t(4)),i=t(5),m=t(7),u=t(6),d=t(8),p=t(135),f=t(136),E=t(133),v=t(11),h=t(26),N="SET_CURRENT_USER",b="REMOVE_CURRENT_USER",g=function(e){return{type:N,payload:e}},x=function(){return{type:b}},y={isAuth:!1,user:null},C="SET_CURRENT_SERVICE_DETAIL",_=function(e){return{type:C,payload:e}},O={isEditing:!1,data:null},S=Object(h.b)({session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case N:return{isAuth:!0,user:n};case b:return localStorage.removeItem("jwtToken"),y;default:return e}},serviceDetails:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case C:return n?{isEditing:n.isEditing?n.isEditing:e.isEditing,data:n.data}:O;default:return e}}}),j=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),w=Object(h.c)(S,j),D=t(3),k=t.n(D),M=t(59),q=t.n(M),Y=(t(92),t(93),function(e){k.a.defaults.headers.common.Authorization=e}),T=function(){delete k.a.defaults.headers.common.Authorization},P=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(m.a)(this,(e=Object(u.a)(a)).call.apply(e,[this].concat(r)))).logout=function(){t.props.removeCurrentUser(),T()},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("nav",{className:"navbar navbar-expand-sm navbar-light fixed-top"},l.a.createElement("div",{className:"container"},l.a.createElement("a",{className:"navbar-brand",href:"/"},"Panel de administraci\xf3n"),l.a.createElement("ul",{className:"navbar-nav mr-auto"},l.a.createElement("li",{className:"nav-item"},l.a.createElement("a",{className:"nav-link",href:"/"},"PuntoLab"))),l.a.createElement("ul",{className:"navbar-nav"},l.a.createElement("li",{className:"nav-item"},l.a.createElement("h5",{onClick:this.logout,className:"nav-link"},"Cerrar sesi\xf3n")))))}}]),a}(r.Component),F={removeCurrentUser:x},R=Object(v.b)(null,F)(P),I=t(60),z=t.n(I),A=(t(94),t(28)),L=t(132),V=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).state={menu:A.menu},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=this.state.menu,a=this.props.session;return l.a.createElement("div",{className:"main-menu"},l.a.createElement("ul",null,l.a.createElement("div",{className:"profile"},l.a.createElement("img",{src:z.a,alt:"logo"}),l.a.createElement("p",null,"BIENVENIDO"),l.a.createElement("h6",null,a.user?a.user.nombre:"")),l.a.createElement("div",{className:"MenuItemsContainer"},e.map(function(e,t){var n=e.items.map(function(e,n){return 0===e.permisos.filter(function(e){return e===a.user.permisos}).length?null:l.a.createElement("li",{key:t+n.toString()},l.a.createElement(L.a,{to:e.url},l.a.createElement("i",{className:"material-icons"}," ",e.icon," "),l.a.createElement("span",{className:"menu-title"},e.name)))});return 0===n.length?null:l.a.createElement("div",{key:t},l.a.createElement("li",{className:"nav-header"},e.title),n)}))))}}]),a}(r.Component),U=Object(v.b)(function(e){return{session:e.session}})(V),H=t(20),B=t(13),W=t.n(B),G=t(1),$=t(10),X="PuntoLab",J=(t(108),function(e){function a(){return Object(s.a)(this,a),Object(m.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(d.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("div",{id:"main"},l.a.createElement("div",{className:"container pb-4"},l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-wrapper"},this.props.children))))}}]),a}(r.Component)),K=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).pagination=function(e){t.setState({index:e},function(){t.requestData()})},t.itemsToShowChanges=function(e){var a=e.target.value;t.setState({itemsToShow:a,index:0},function(){t.requestData()})},t.filter=function(e){if("Enter"===e.key){var a=e.target.value;t.setState({index:0,filterWord:a},function(){t.requestData()})}},t.delete=function(e,a){var n=t.props.session.user.permisos;W.a.prompt("Confirma la eliminaci\xf3n","Ingresa ".concat(0===n?"tu contrase\xf1a":"una contrase\xf1a de administrador"," para eliminar a ").concat(a),"",function(a,r){k.a.post("/api/clientes/eliminar",{password:r,_id:e}).then(function(e){G.toast.info("Se elimin\xf3 el cliente".concat(0===n?".":" con autorizaci\xf3n de "+e.data.admin)),t.requestData()}).catch(function(e){return e.response&&401===e.response.status?G.toast.warn("La contrase\xf1a".concat(0===n?"":" de administrador"," es incorrecta.")):e.response&&302===e.response.status?G.toast.warn("No se puede eliminar al cliente porque tiene servicios relacionados"):G.toast.error("No se pudo eliminar el cliente - "+e)})},function(){}).set("type","password").set("labels",{ok:"Aceptar",cancel:"Cancelar"})},t.state={clientes:[],index:0,itemsToShow:5,totalItems:0,filterWord:""},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"requestData",value:function(){var e=this,a=this.state,t=a.itemsToShow,n=a.index,r=a.filterWord;k.a.post("/api/clientes/listar",{itemsToShow:t,filtro:r,salto:t*n}).then(function(a){if(a.data){var t=a.data,n=t.clientes,r=t.totalItems;e.setState({clientes:n,totalItems:r})}}).catch(function(e){return G.toast.warn("No se puede mostrar la informaci\xf3n - "+e)})}},{key:"componentDidMount",value:function(){this.requestData()}},{key:"render",value:function(){var e=this,a=this.state,t=a.clientes,n=a.index,r=a.totalItems,c=a.itemsToShow,o=Math.ceil(r/c),s=c*(n+1);return l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Clientes | ",X)),l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("h2",null,l.a.createElement("span",null,"Clientes "))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement(L.a,{to:"/clientes/crear",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," add ")," ",l.a.createElement("span",null,"Agregar"))))),l.a.createElement("div",{className:"table-filter"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"show-entries"},l.a.createElement("span",null,"Mostrar"),l.a.createElement("select",{onChange:this.itemsToShowChanges},l.a.createElement("option",null,"5"),l.a.createElement("option",null,"10"),l.a.createElement("option",null,"15"),l.a.createElement("option",null,"20"),l.a.createElement("option",null,"25"),l.a.createElement("option",null,"30")),l.a.createElement("span",null,"campos"))),l.a.createElement("div",{className:"col-sm-9"},l.a.createElement("div",{className:"filter-group"},l.a.createElement("label",null,"Buscar nombre"),l.a.createElement("input",{type:"text",className:"form-control",onKeyDown:this.filter}))))),l.a.createElement("table",{className:"table"},l.a.createElement("thead",{className:"thead-light"},l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"Nombre"),l.a.createElement("th",{scope:"col"},"Tel\xe9fono"),l.a.createElement("th",{scope:"col"},"Direcci\xf3n"),l.a.createElement("th",{scope:"col"},"Ciudad"),l.a.createElement("th",{scope:"col"},"Editar"),l.a.createElement("th",{scope:"col"},"Eliminar"))),l.a.createElement("tbody",null,t.map(function(a){var t=a._id,n=a.nombre,r=a.telefono,c=a.direccion,o=a.comunidad,s=a.ciudad;return l.a.createElement("tr",{key:t},l.a.createElement("td",null,n),l.a.createElement("td",null,r),l.a.createElement("td",null,c),l.a.createElement("td",null,o?o+", ":""," ",s),l.a.createElement("td",null,l.a.createElement(L.a,{to:"/clientes/editar/"+t},l.a.createElement("i",{className:"material-icons"}," edit "))),l.a.createElement("td",{onClick:function(){return e.delete(t,n)}},l.a.createElement("i",{className:"material-icons"}," delete ")))}))),l.a.createElement("div",{className:"clearfix mt-2"},l.a.createElement("div",{className:"hint-text"},"Mostrando ",l.a.createElement("b",null,s>r?r:s)," de ",l.a.createElement("b",null,r)," entradas"),l.a.createElement("ul",{className:"pagination"},Object(H.a)(Array(o)).map(function(a,t){return l.a.createElement("li",{key:t,onClick:function(){return e.pagination(t)},className:n===t?"page-item active":"page-item"}," ",l.a.createElement("span",{className:"page-link"}," ",t+1," "))}))))}}]),a}(r.Component),Q=Object(v.b)(function(e){return{session:e.session}})(K),Z=t(12),ee=t(137),ae=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).state={notFound:{title:"El contenido no existe",details:"La direcci\xf3n que has solicitado no se encontr\xf3."},unautorized:{title:"Acceso denegado",details:"No tienes permiso para ver este contenido"}},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=this.props.statusCode||404,a=this.state,t=a.notFound,n=a.unautorized;return l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,404===e?"404":"401"," | ",X)),l.a.createElement("h4",null,404===e?t.title:n.title),l.a.createElement("p",{style:{marginTop:"20px",fontWeight:"300"}},404===e?t.details:n.details))}}]),a}(r.Component),te=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).onSubmit=function(e){e.preventDefault();var a=t.state,n=a._id,r=a.nombre,l=a.telefono,c=a.direccion,o=a.ciudad,s=a.comunidad,i=a.isEditing;k.a.post("/"+"api/clientes".concat(i?"/editar":"/nuevo"),{_id:n,nombre:r,telefono:l,direccion:c,ciudad:o,comunidad:s}).then(function(e){G.toast.success("Cliente ".concat(i?"editado":"creado")),t.props.history.push("/clientes")}).catch(function(e){return G.toast.warn("No se pudo ".concat(i?"editar":"crear"," el cliente - ").concat(e))})},t.onChange=function(e){var a=e.target,n=a.name,r=a.value;t.setState(Object(Z.a)({},n,r))},t.state={_id:void 0,nombre:void 0,telefono:void 0,direccion:void 0,ciudad:void 0,comunidad:void 0,isEditing:!1,notFound:!1},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props.match.params.id;a&&(this.setState({isEditing:!0}),k.a.get("/api/clientes/detallar/"+a).then(function(a){var t=a.data,n=t._id,r=t.nombre,l=t.telefono,c=t.direccion,o=t.ciudad,s=t.comunidad;e.setState({_id:n,nombre:r,telefono:l,direccion:c,ciudad:o,comunidad:s})}).catch(function(a){if(404===a.response.status)return e.setState({notFound:!0});G.toast.warn("No se puede mostrar la informaci\xf3n - "+a)}))}},{key:"render",value:function(){var e=this.state,a=e.nombre,t=e.telefono,n=e.direccion,r=e.ciudad,c=e.comunidad,o=e.isEditing;return e.notFound?l.a.createElement(ae,null):l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,o?"Editar":"Crear"," cliente | ",X)),l.a.createElement("form",{onSubmit:this.onSubmit},l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},o?l.a.createElement("h2",null,l.a.createElement("span",null,"Editar a "),a):l.a.createElement("h2",null,l.a.createElement("span",null,"Crear "),"cliente")),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("button",{type:"submit",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," backup ")," ",l.a.createElement("span",null,o?"Guardar":"Crear"))))),l.a.createElement("div",{className:"form-content"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{onChange:this.onChange,value:a||"",type:"text",className:"form-control form-control frm_field",placeholder:"Nombre(s), Apellido Paterno, Apellido Materno",name:"nombre",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"* Escribe el nombre del cliente"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{onChange:this.onChange,value:t||"",type:"text",className:"form-control form-control frm_field",placeholder:"Telefono",name:"telefono"}),l.a.createElement("small",{className:"form-text text-muted"},"N\xfamero tel\xe9fonico del cliente"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{onChange:this.onChange,value:n||"",type:"text",className:"form-control form-control frm_field",placeholder:"Direcci\xf3n",name:"direccion",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"* Direcci\xf3n del cliente"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{onChange:this.onChange,value:r||"",type:"text",className:"form-control form-control frm_field",placeholder:"Ciudad",name:"ciudad",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"* Ciudad del cliente"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{onChange:this.onChange,value:c||"",type:"text",className:"form-control form-control frm_field",placeholder:"Comunidad",name:"comunidad"}),l.a.createElement("small",{className:"form-text text-muted"},"Comunidad del cliente")))))))}}]),a}(r.Component),ne=Object(ee.a)(te),re=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).delete=function(e,a){var n=t.props.session.user.permisos;W.a.prompt("Confirma la eliminaci\xf3n","Ingresa ".concat(0===n?"tu contrase\xf1a":"una contrase\xf1a de administrador"," para eliminar a ").concat(a),"",function(a,r){k.a.post("/api/pv/eliminar",{password:r,_id:e}).then(function(e){G.toast.info("Se elimin\xf3 el pv".concat(0===n?".":" con autorizaci\xf3n de "+e.data.admin)),t.requestData()}).catch(function(e){return e.response&&401===e.response.status?G.toast.warn("La contrase\xf1a".concat(0===n?"":" de administrador"," es incorrecta.")):e.response&&302===e.response.status?G.toast.error("No se puede eliminar el PV porque tiene fichas relacionadas"):G.toast.error("No se pudo eliminar el pv - "+e)})},function(){}).set("type","password").set("labels",{ok:"Aceptar",cancel:"Cancelar"})},t.state={pvs:[]},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){this.requestData()}},{key:"requestData",value:function(){var e=this;k.a.get("/api/pv/listar").then(function(a){a.data&&e.setState({pvs:a.data})}).catch(function(e){return G.toast.warn("No se puede mostrar la informaci\xf3n - "+e)})}},{key:"render",value:function(){var e=this;return l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Punto de venta | ",X)),l.a.createElement("div",{className:"header",style:{marginBottom:"0px"}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("h2",null,l.a.createElement("span",null,"Punto de venta"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement(L.a,{to:"/puntodeventa/crear",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," add ")," ",l.a.createElement("span",null,"Agregar"))))),l.a.createElement("table",{className:"table"},l.a.createElement("thead",{className:"thead-light"},l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"Nombre"),l.a.createElement("th",{scope:"col"},"Localidad"),l.a.createElement("th",{scope:"col"},"Antena"),l.a.createElement("th",{scope:"col"},"Enlace"),l.a.createElement("th",{scope:"col"},"Router"),l.a.createElement("th",{scope:"col"},"IP"),l.a.createElement("th",{scope:"col"},"Editar"),l.a.createElement("th",{scope:"col"},"Eliminar"))),l.a.createElement("tbody",null,this.state.pvs.map(function(a){var t=a._id,n=a.nombre,r=a.localidad,c=a.antena,o=a.enlace,s=a.router,i=a.ip;return l.a.createElement("tr",{key:t},l.a.createElement("td",null,n),l.a.createElement("td",null,r),l.a.createElement("td",null,c),l.a.createElement("td",null,o),l.a.createElement("td",null,s),l.a.createElement("td",null,i),l.a.createElement("td",null,l.a.createElement(L.a,{to:"/puntodeventa/editar/"+t},l.a.createElement("i",{className:"material-icons"}," edit "))),l.a.createElement("td",{onClick:function(){return e.delete(t,n)}},l.a.createElement("i",{className:"material-icons"}," delete ")))}))))}}]),a}(r.Component),le=Object(v.b)(function(e){return{session:e.session}})(re),ce=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).onChange=function(e){var a=e.target,n=a.name,r=a.value;t.setState(Object(Z.a)({},n,r))},t.onSubmit=function(e){e.preventDefault();var a=t.state.isEditing;k.a.post("/"+"api/pv".concat(a?"/editaro":"/nuevo"),t.state).then(function(e){G.toast.success("PV ".concat(a?"editado":"creado")),t.props.history.push("/puntodeventa")}).catch(function(e){return G.toast.warn("No se pudo ".concat(a?"editar":"crear"," el PV - ").concat(e))})},t.state={_id:void 0,nombre:void 0,localidad:void 0,antena:void 0,enlace:void 0,router:void 0,ip:void 0,isEditing:!1,notFound:!1},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props.match.params.id;a&&(this.setState({isEditing:!0}),k.a.get("/api/pv/detallar/"+a).then(function(a){var t=a.data,n=t._id,r=t.nombre,l=t.localidad,c=t.antena,o=t.enlace,s=t.router,i=t.ip;e.setState({_id:n,nombre:r,localidad:l,antena:c,enlace:o,router:s,ip:i})}).catch(function(a){if(404===a.response.status)return e.setState({notFound:!0});G.toast.warn("No se puede mostrar la informaci\xf3n - "+a)}))}},{key:"render",value:function(){var e=this.state,a=e.nombre,t=e.localidad,n=e.antena,r=e.enlace,c=e.router,o=e.ip,s=e.isEditing;return e.notFound?l.a.createElement(ae,null):l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,s?"Editar":"Crear"," cliente | ",X)),l.a.createElement("form",{onSubmit:this.onSubmit},l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},s?l.a.createElement("h2",null,l.a.createElement("span",null,"Editar a "),a):l.a.createElement("h2",null,l.a.createElement("span",null,"Crear "),"pv")),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("button",{type:"submit",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," backup ")," ",l.a.createElement("span",null,s?"Guardar":"Crear"))))),l.a.createElement("div",{className:"form-content"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-6"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{onChange:this.onChange,value:a||"",type:"text",className:"form-control form-control frm_field",placeholder:"Nombre",name:"nombre",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"* Escribe el nombre"))),l.a.createElement("div",{className:"col-sm-6"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{onChange:this.onChange,value:t||"",type:"text",className:"form-control form-control frm_field",placeholder:"Localidad",name:"localidad",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"* Localidad"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{onChange:this.onChange,value:n||"",type:"text",className:"form-control form-control frm_field",placeholder:"Antena",name:"antena",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"* Antena"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{onChange:this.onChange,value:r||"",type:"text",className:"form-control form-control frm_field",placeholder:"Enlace",name:"enlace",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"* Enlace"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{required:!0,onChange:this.onChange,value:c||"",type:"text",className:"form-control form-control frm_field",placeholder:"Router",name:"router"}),l.a.createElement("small",{className:"form-text text-muted"},"* Router"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{onChange:this.onChange,value:o||"",type:"text",className:"form-control form-control frm_field",placeholder:"IP",name:"ip",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"* IP")))))))}}]),a}(r.Component),oe=(t(110),function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).delete=function(e){var a=t.props.session.user.permisos;W.a.prompt("Confirma la eliminaci\xf3n","Ingresa ".concat(0===a?"tu contrase\xf1a":"una contrase\xf1a de administrador"," para eliminar la ficha"),"",function(n,r){k.a.post("/api/fichas/eliminar",{password:r,_id:e}).then(function(e){G.toast.info("Se elimin\xf3 la ficha".concat(0===a?".":" con autorizaci\xf3n de "+e.data.admin)),t.requestData()}).catch(function(e){return e.response&&401===e.response.status?G.toast.warn("La contrase\xf1a".concat(0===a?"":" de administrador"," es incorrecta.")):G.toast.error("No se pudo eliminar la ficha - "+e)})},function(){}).set("type","password").set("labels",{ok:"Aceptar",cancel:"Cancelar"})},t.state={fichas:[]},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"requestData",value:function(){var e=this;k.a.get("/api/fichas/listar").then(function(a){a.data&&e.setState({fichas:a.data})}).catch(function(e){return G.toast.warn("No se puede mostrar la informaci\xf3n - "+e)})}},{key:"componentDidMount",value:function(){this.requestData()}},{key:"render",value:function(){var e=this,a=this.state.fichas;return l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Fichas | ",X)),l.a.createElement("div",{className:"header",style:{marginBottom:"0px"}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("h2",null,l.a.createElement("span",null,"Fichas"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement(L.a,{to:"/fichas/crear",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," add ")," ",l.a.createElement("span",null,"Agregar"))))),l.a.createElement("table",{className:"table"},l.a.createElement("thead",{className:"thead-light"},l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"Nombre"),l.a.createElement("th",{scope:"col"},"Entregado"),l.a.createElement("th",{scope:"col"},"Prefijo"),l.a.createElement("th",{scope:"col"},"Vendidas"),l.a.createElement("th",{scope:"col"},"Costo"),l.a.createElement("th",{scope:"col"},"Total"),l.a.createElement("th",{scope:"col"},"Comisi\xf3n"),l.a.createElement("th",{scope:"col"},"Neto"),l.a.createElement("th",{scope:"col"},"Editar"),l.a.createElement("th",{scope:"col"},"Eliminar"))),l.a.createElement("tbody",null,a.map(function(a){var t=a._id,n=a.pv,r=a.cantidad,c=a.prefijo,o=a.costo,s=a.vendidas,i=a.comision,m=a.ganancia_neta,u=a.total_cobrado,d=a.folio_error;return l.a.createElement("tr",{key:t,className:""!==d?"rowError":null},l.a.createElement("td",null,n.nombre),l.a.createElement("td",null,"$",r),l.a.createElement("td",null,c),l.a.createElement("td",null,s),l.a.createElement("td",null,"$",o),l.a.createElement("td",null,"$",u),l.a.createElement("td",null,i,"%"),l.a.createElement("td",null,"$",m),l.a.createElement("td",null,l.a.createElement(L.a,{to:"/fichas/editar/"+t},l.a.createElement("i",{className:"material-icons"}," edit "))),l.a.createElement("td",{onClick:function(){return e.delete(t)}},l.a.createElement("i",{className:"material-icons"}," delete ")))})),l.a.createElement("tbody",null)))}}]),a}(r.Component)),se=Object(v.b)(function(e){return{session:e.session}})(oe),ie=t(32),me=t.n(ie),ue=k.a.CancelToken,de=function(e){return e.nombre},pe=function(e){return l.a.createElement("div",null,e.nombre," ",l.a.createElement("div",{className:"details"},e.localidad," - ",e.ip))},fe=function(e){function a(){var e;return Object(s.a)(this,a),(e=Object(m.a)(this,Object(u.a)(a).call(this))).getSuggestions=function(a){var t=e.state.pv,n=a.trim().toLowerCase();return 0===n.length?[]:t.filter(function(e){return e.nombre.toLowerCase().includes(n.toLowerCase())})},e.onChange=function(a,t){var n=t.newValue;(0,e.props.updatePV)(void 0),e.setState({value:n})},e.onSuggestionsFetchRequested=function(a){var t=a.value;e.setState({suggestions:e.getSuggestions(t)})},e.onSuggestionsClearRequested=function(){e.setState({suggestions:[]})},e.onSuggestionSelected=function(a,t){var n=t.suggestion;t.method;(0,e.props.updatePV)(n)},e.state={value:"",suggestions:[],pv:[]},e}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentWillUnmount",value:function(){n("cantFill")}},{key:"componentDidMount",value:function(){var e=this;k()({method:"get",url:"/api/pv/listar",cancelToken:new ue(function(e){n=e})}).then(function(a){if(a.data){var t=a.data;e.setState({suggestions:t,pv:t})}}).catch(function(e){e.message&&"cantFill"!==e.message&&G.toast.warn("No se pueden listar los puntos de venta - "+e)})}},{key:"render",value:function(){var e=this.state,a=e.value,t=e.suggestions,n=e.pv,r={placeholder:0===n.length?"No tienes puntos de venta creados":"Nombre PV",value:a,onChange:this.onChange,disabled:0===n.length};return l.a.createElement(me.a,{suggestions:t,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:de,onSuggestionSelected:this.onSuggestionSelected,renderSuggestion:pe,inputProps:r})}}]),a}(r.Component),Ee=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).updatePV=function(e){t.setState({pv:e})},t.onChange=function(e){var a=e.target,n=a.name,r=a.value;t.setState(Object(Z.a)({},n,r),function(){"costo"!==n&&"vendidas"!==n&&"comision"!==n||t.calculos()})},t.calculos=function(){var e=t.state,a=e.costo,n=e.vendidas,r=e.comision;if(!Number.isNaN(a)&&!Number.isNaN(n)){var l=a*n,c=l-l*r/100;t.setState({total_cobrado:l,ganancia_neta:c})}},t.onSubmit=function(e){e.preventDefault();var a=t.state,n=a._id,r=a.pv,l=a.cantidad,c=a.prefijo,o=a.costo,s=a.plan,i=a.vendidas,m=a.total_cobrado,u=a.comision,d=a.ganancia_neta,p=a.folio_error,f=a.isEditing;if(!r)return G.toast.warn("Completa el campo de nombre");k.a.post("/"+"api/fichas".concat(f?"/editar":"/nuevo"),{_id:n,pv:r._id,cantidad:l,prefijo:c,costo:o,plan:s,vendidas:i,total_cobrado:m,comision:u,ganancia_neta:d,folio_error:p}).then(function(e){G.toast.success("Ficha ".concat(f?"editada":"creada")),t.props.history.push("/fichas")}).catch(function(e){return G.toast.warn("No se pudo ".concat(f?"editar":"crear"," la ficha - ").concat(e))})},t.state={_id:void 0,pv:void 0,cantidad:0,prefijo:"",costo:0,plan:"",vendidas:0,total_cobrado:0,comision:5,ganancia_neta:0,folio_error:"",isEditing:!1,notFound:!1},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props.match.params.id;a&&(this.setState({isEditing:!0}),k.a.get("/api/fichas/detallar/"+a).then(function(a){var t=a.data,n=t._id,r=t.pv,l=t.cantidad,c=t.prefijo,o=t.costo,s=t.plan,i=t.vendidas,m=t.total_cobrado,u=t.comision,d=t.ganancia_neta,p=t.error,f=t.folio_error;e.setState({_id:n,pv:r,cantidad:l,prefijo:c,costo:o,plan:s,vendidas:i,total_cobrado:m,comision:u,ganancia_neta:d,error:p,folio_error:f})}).catch(function(a){if(404===a.response.status)return e.setState({notFound:!0});G.toast.warn("No se puede mostrar la informaci\xf3n - "+a)}))}},{key:"render",value:function(){var e=this.state,a=e.pv,t=e.cantidad,n=e.prefijo,r=e.costo,c=e.plan,o=e.vendidas,s=e.total_cobrado,i=e.comision,m=e.ganancia_neta,u=e.folio_error,d=e.isEditing;return e.notFound?l.a.createElement(ae,null):l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,d?"Editar":"Crear"," ficha | ",X)),l.a.createElement("form",{onSubmit:this.onSubmit},l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},d?l.a.createElement("h2",null,l.a.createElement("span",null,"Editar ficha")):l.a.createElement("h2",null,l.a.createElement("span",null,"Crear "),"ficha")),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("button",{type:"submit",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," backup ")," ",l.a.createElement("span",null,d?"Guardar":"Crear"))))),l.a.createElement("div",{className:"form-content"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-6"},d?l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{disabled:!0,value:a&&a.nombre?a.nombre:"",type:"text",className:"form-control form-control frm_field",placeholder:"Localidad"}),l.a.createElement("small",{className:"form-text text-muted"},"* Nombre")):l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement(fe,{updatePV:this.updatePV,updatePVStatus:this.updatePVStatus}),l.a.createElement("small",{className:"form-text text-muted"},"* Escribe el nombre"))),l.a.createElement("div",{className:"col-sm-6"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{disabled:!0,value:a&&a.localidad?a.localidad:"",type:"text",className:"form-control form-control frm_field",placeholder:"Localidad"}),l.a.createElement("small",{className:"form-text text-muted"},"* Localidad"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{disabled:!0,value:a&&a.antena?a.antena:"",type:"text",className:"form-control form-control frm_field",placeholder:"Antena"}),l.a.createElement("small",{className:"form-text text-muted"},"* Antena"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{disabled:!0,value:a&&a.enlace?a.enlace:"",type:"text",className:"form-control form-control frm_field",placeholder:"Enlace"}),l.a.createElement("small",{className:"form-text text-muted"},"* Enlace"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{disabled:!0,value:a&&a.router?a.router:"",type:"text",className:"form-control form-control frm_field",placeholder:"Router"}),l.a.createElement("small",{className:"form-text text-muted"},"* Router"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{disabled:!0,value:a&&a.ip?a.ip:"",type:"text",className:"form-control form-control frm_field",placeholder:"IP"}),l.a.createElement("small",{className:"form-text text-muted"},"* IP"))),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{required:!0,onChange:this.onChange,value:t||"",type:"number",className:"form-control form-control frm_field",placeholder:"$0.00",name:"cantidad"}),l.a.createElement("small",{className:"form-text text-muted"},"* Cantidad entregada"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{onChange:this.onChange,value:n||"",type:"text",className:"form-control form-control frm_field",placeholder:"Prefijo",name:"prefijo",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"* Prefijo"))),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{onChange:this.onChange,value:r||"",type:"number",className:"form-control form-control frm_field",placeholder:"0",name:"costo",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"* Costo"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{required:!0,onChange:this.onChange,value:c||"",type:"text",className:"form-control form-control frm_field",placeholder:"Plan",name:"plan"}),l.a.createElement("small",{className:"form-text text-muted"},"* Plan"))),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{required:!0,onChange:this.onChange,value:o||"",type:"number",className:"form-control form-control frm_field",placeholder:"0",name:"vendidas"}),l.a.createElement("small",{className:"form-text text-muted"},"* Vendidas"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{disabled:!0,onChange:this.onChange,value:s||"",type:"number",className:"form-control form-control frm_field",placeholder:"0.00",name:"total_cobrado"}),l.a.createElement("small",{className:"form-text text-muted"},"Total cobrado"))),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("select",{className:"form-control form-control frm_field",value:i,onChange:this.onChange,name:"comision",required:!0},l.a.createElement("option",{key:"5",value:"5"},"5%"),l.a.createElement("option",{key:"10",value:"10"},"10%"),l.a.createElement("option",{key:"15",value:"15"},"15%")),l.a.createElement("small",{className:"form-text text-muted"},"Comisi\xf3n"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{disabled:!0,onChange:this.onChange,value:m||"",type:"number",className:"form-control form-control frm_field",placeholder:"0.00",name:"ganancia_neta"}),l.a.createElement("small",{className:"form-text text-muted"},"Ganancia neta"))),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{onChange:this.onChange,value:u||"",type:"text",className:"form-control form-control frm_field",placeholder:"Folio",name:"folio_error"}),l.a.createElement("small",{className:"form-text text-muted"},"Folio del error")))))))}}]),a}(r.Component),ve=t(17),he=t.n(ve),Ne=t(9),be=t.n(Ne);t(24);be.a.locale("es");var ge,xe=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).requestData=function(){var e,a=t.state,n=a.itemsToShow,r=a.index,l=t.props.session.user,c=l.permisos,o=l._id;2===c&&(e=o),k.a.post("/api/servicios/listar",{tecnico_id:e,itemsToShow:n,salto:n*r}).then(function(e){if(e.data){var a=e.data,n=a.servicios,r=a.totalItems;t.setState({servicios:n,totalItems:r})}}).catch(function(e){return G.toast.warn("No se pueden listar los servicios - "+e)})},t.itemsToShowChanges=function(e){var a=e.target.value;t.setState({itemsToShow:a,index:0},function(){t.requestData()})},t.pagination=function(e){t.setState({index:e},function(){t.requestData()})},t.state={servicios:[],index:0,itemsToShow:5,totalItems:0},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){this.requestData()}},{key:"render",value:function(){var e=this,a=this.state,t=a.servicios,n=a.index,r=a.totalItems,c=a.itemsToShow,o=Math.ceil(r/c),s=c*(n+1);return l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Servicios | ",X)),l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("h2",null,l.a.createElement("span",null,"Servicios "))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement(L.a,{to:"/servicios/crear",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," add ")," ",l.a.createElement("span",null,"Agregar"))))),l.a.createElement("div",{className:"table-filter"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("div",{className:"show-entries"},l.a.createElement("span",null,"Mostrar"),l.a.createElement("select",{onChange:this.itemsToShowChanges},l.a.createElement("option",null,"5"),l.a.createElement("option",null,"10"),l.a.createElement("option",null,"15"),l.a.createElement("option",null,"20"),l.a.createElement("option",null,"25"),l.a.createElement("option",null,"30")),l.a.createElement("span",null,"campos"))))),l.a.createElement("table",{className:"table"},l.a.createElement("thead",{className:"thead-light"},l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"Vencimiento"),l.a.createElement("th",{scope:"col"},"Servicio"),l.a.createElement("th",{scope:"col"},"Cliente"),l.a.createElement("th",{scope:"col"},"Ciudad"),l.a.createElement("th",{scope:"col"},"Estado"))),l.a.createElement("tbody",null,t.map(function(e){return l.a.createElement("tr",{key:e._id},l.a.createElement("td",null,be()(e.fechaTentativa,"YYYYMMDD").local().format("MMMM DD [de] [']YY")),l.a.createElement("td",null,he.a.filter(function(a){return a.id===e.tipo})[0].descripcion),l.a.createElement("td",null,e.cliente.nombre),l.a.createElement("td",null,e.cliente.comunidad?e.cliente.comunidad+", ":"",e.cliente.ciudad),l.a.createElement("td",null,l.a.createElement(L.a,{to:"/servicios/"+e.tipo+"/ver/"+e._id},!1===e.sc?l.a.createElement("i",{className:"material-icons"}," access_time "):l.a.createElement("i",{className:"material-icons"}," done "))))}))),l.a.createElement("div",{className:"clearfix mt-2"},l.a.createElement("div",{className:"hint-text"},"Mostrando ",l.a.createElement("b",null,s>r?r:s)," de ",l.a.createElement("b",null,r)," entradas"),l.a.createElement("ul",{className:"pagination"},Object(H.a)(Array(o)).map(function(a,t){return l.a.createElement("li",{key:t,onClick:function(){return e.pagination(t)},className:n===t?"page-item active":"page-item"}," ",l.a.createElement("span",{className:"page-link"}," ",t+1," "))}))))}}]),a}(r.Component),ye=Object(v.b)(function(e){return{session:e.session}})(xe),Ce=(t(123),k.a.CancelToken),_e=function(e){return e.nombre},Oe=function(e){return l.a.createElement("div",null,e.nombre," ",l.a.createElement("div",{className:"details"},e.direccion,", ",e.comunidad?e.comunidad+", ":""," ",e.ciudad))},Se=function(e){function a(){var e;return Object(s.a)(this,a),(e=Object(m.a)(this,Object(u.a)(a).call(this))).getSuggestions=function(a){var t=e.state.clientes,n=a.trim().toLowerCase();return 0===n.length?[]:t.filter(function(e){return e.nombre.toLowerCase().includes(n.toLowerCase())})},e.onChange=function(a,t){var n=t.newValue;(0,e.props.updateCliente)(void 0),e.setState({value:n})},e.onSuggestionsFetchRequested=function(a){var t=a.value;e.setState({suggestions:e.getSuggestions(t)})},e.onSuggestionsClearRequested=function(){e.setState({suggestions:[]})},e.onSuggestionSelected=function(a,t){var n=t.suggestion;t.method;(0,e.props.updateCliente)(n)},e.state={value:"",suggestions:[],clientes:[]},e}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentWillUnmount",value:function(){ge("cantFill")}},{key:"componentDidMount",value:function(){var e=this;k()({method:"post",url:"/api/clientes/listar",data:{itemsToShow:void 0,filtro:void 0,salto:0},cancelToken:new Ce(function(e){ge=e})}).then(function(a){if(a.data){var t=a.data.clientes;e.setState({suggestions:t,clientes:t})}}).catch(function(e){e.message&&"cantFill"!==e.message&&G.toast.warn("No se pueden listar los clientes - "+e)})}},{key:"render",value:function(){var e=this.state,a=e.value,t=e.suggestions,n=e.clientes,r={placeholder:0===n.length?"No tienes clientes creados":"Nombre",value:a,onChange:this.onChange,disabled:0===n.length};return l.a.createElement(me.a,{suggestions:t,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:_e,onSuggestionSelected:this.onSuggestionSelected,renderSuggestion:Oe,inputProps:r})}}]),a}(r.Component),je=t(33),we=t.n(je),De=t(22),ke=t.n(De),Me=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).onChange=function(e){var a=e.target,n=a.name,r=a.value;t.setState(Object(Z.a)({},n,r),function(){t.props.setServiceDetails({data:t.state})})},t.state={costo:"1.00",netflix:"false",paquete:"0",tipoPago:"0"},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.setServiceDetails({data:this.state})}},{key:"componentWillReceiveProps",value:function(e){if(e.serviceData&&!0===e.serviceData.isEditing&&e.serviceData.data){var a=e.serviceData.data,t=a.costo,n=a.netflix,r=a.paquete,l=a.tipoPago;this.setState({costo:t,netflix:n,paquete:r,tipoPago:l})}}},{key:"componentWillUnmount",value:function(){this.props.setServiceDetails(null)}},{key:"render",value:function(){var e=this.state,a=e.costo,t=e.netflix,n=e.paquete,r=e.tipoPago;return l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("select",{className:"form-control form-control frm_field",value:n,onChange:this.onChange,name:"paquete",required:!0},we.a.map(function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.nombre)})),l.a.createElement("small",{className:"form-text text-muted"},"Tipo de paquete"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{type:"number",className:"form-control form-control frm_field",value:a,onChange:this.onChange,min:"1",name:"costo",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"Costo de inst."))),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("select",{className:"form-control form-control frm_field",value:t,onChange:this.onChange,name:"netflix",required:!0},l.a.createElement("option",{value:"false"},"No"),l.a.createElement("option",{value:"true"},"S\xed")),l.a.createElement("small",{className:"form-text text-muted"},"Netflix"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("select",{className:"form-control form-control frm_field",value:r,onChange:this.onChange,name:"tipoPago",required:!0},ke.a.map(function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.nombre)})),l.a.createElement("small",{className:"form-text text-muted"},"Forma de pago"))))}}]),a}(r.Component),qe={setServiceDetails:_},Ye=Object(v.b)(function(e){return{serviceData:e.serviceDetails}},qe)(Me),Te=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).onChange=function(e){var a=e.target,n=a.name,r=a.value;t.setState(Object(Z.a)({},n,r),function(){t.props.setServiceDetails({data:t.state})})},t.state={camaras:"1",costo:"1.00",tipoPago:"0"},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.setServiceDetails({data:this.state})}},{key:"componentWillReceiveProps",value:function(e){if(e.serviceData&&!0===e.serviceData.isEditing&&e.serviceData.data){var a=e.serviceData.data,t=a.camaras,n=a.costo,r=a.tipoPago;this.setState({costo:n,camaras:t,tipoPago:r})}}},{key:"componentWillUnmount",value:function(){this.props.setServiceDetails(null)}},{key:"render",value:function(){var e=this.state,a=e.camaras,t=e.costo,n=e.tipoPago;return l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{type:"number",className:"form-control form-control frm_field",min:"1",value:a,name:"camaras",required:!0,onChange:this.onChange}),l.a.createElement("small",{className:"form-text text-muted"},"C\xe1maras"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{type:"number",className:"form-control form-control frm_field",value:t,name:"costo",min:"1",required:!0,onChange:this.onChange}),l.a.createElement("small",{className:"form-text text-muted"},"Costo de instalaci\xf3n"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("select",{className:"form-control form-control frm_field",value:n,onChange:this.onChange,name:"tipoPago",required:!0},ke.a.map(function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.nombre)})),l.a.createElement("small",{className:"form-text text-muted"},"Forma de pago"))))}}]),a}(r.Component),Pe={setServiceDetails:_},Fe=Object(v.b)(function(e){return{serviceData:e.serviceDetails}},Pe)(Te),Re=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).onChange=function(e){var a=e.target,n=a.name,r=a.value;t.setState(Object(Z.a)({},n,r),function(){t.props.setServiceDetails({data:t.state})})},t.state={problema:""},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.setServiceDetails({data:this.state})}},{key:"componentWillReceiveProps",value:function(e){if(e.serviceData&&!0===e.serviceData.isEditing&&e.serviceData.data){var a=e.serviceData.data.problema;this.setState({problema:a})}}},{key:"componentWillUnmount",value:function(){this.props.setServiceDetails(null)}},{key:"render",value:function(){var e=this.state.problema;return l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",className:"form-control form-control frm_field",required:!0,value:e,name:"problema",onChange:this.onChange}),l.a.createElement("small",{className:"form-text text-muted"},"Falla"))))}}]),a}(r.Component),Ie={setServiceDetails:_},ze=Object(v.b)(function(e){return{serviceData:e.serviceDetails}},Ie)(Re),Ae=t(45),Le=t.n(Ae);be.a.locale("es"),Le.a.updateLocale("es",{workingWeekdays:[1,2,3,4,5]});var Ve=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).updateCliente=function(e){t.setState({cliente:e})},t.onChange=function(e){var a=e.target,n=a.name,r=a.value;if("tecnico"===n){var l=t.state.tecnicos.filter(function(e){return e._id===r})[0];l&&3===l.permisos?t.setState({show_pago_tecnico:!0}):t.setState({show_pago_tecnico:!1})}t.setState(Object(Z.a)({},n,r))},t.onSubmit=function(e){e.preventDefault();var a=t.state,n=a._id,r=a.cliente,l=a.servicio,c=a.tecnico,o=a.isEditing,s=a.pago_tecnico,i=a.show_pago_tecnico,m=t.props.serviceData;if(!r)return G.toast.warn("No tienes un cliente seleccionado");var u=be.a.utc(Le()().businessAdd(6)._d).startOf("day").format(),d=be.a.utc().startOf("day").format(),p=!1===o?"api/servicios/"+l+"/nuevo":"api/servicios/"+l+"/editar";k.a.post("/"+p,{_id:n,cliente:r._id,data:m.data,tecnico:c,tipo:l,fechaTentativa:u,fechaSolicitud:d,pago_tecnico:s,show_pago_tecnico:i}).then(function(e){201===e.status&&(G.toast.success("Se ".concat(!0===o?"guard\xf3":"cre\xf3"," el elemento")),o?t.props.history.push("/servicios/"+e.data.tipo+"/ver/"+e.data._id):t.props.history.push("/servicios"))}).catch(function(e){if(e.response&&401===e.response.status)return G.toast.warn("No se puede realizar la acci\xf3n porque el servicio ya se finaliz\xf3");G.toast.error("No se pudo realizar la acci\xf3n - "+e)})},t.state={_id:void 0,tecnicos:[],cliente:void 0,servicio:"0",tecnico:"",isEditing:!1,notFound:!1,pago_tecnico:0,show_pago_tecnico:!1},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;k.a.get("/api/usuarios/listar").then(function(a){if(a.data){var t=a.data.filter(function(e){return 2===e.permisos||3===e.permisos});e.setState({tecnicos:t,tecnico:t[0]._id}),t&&3===t[0].permisos&&e.setState({show_pago_tecnico:!0})}}).catch(function(e){return G.toast.warn("No se pueden listar los t\xe9cnicos - "+e)});var a=this.props.match.params.id;a&&(this.setState({isEditing:!0}),k.a.get("/api/servicios/detallar/"+a).then(function(a){var t=a.data.service,n=t._id,r=t.cliente,l=t.tipo,c=t.tecnico,o=t.pagoTecnico,s=3===c.permisos;e.setState({_id:n,cliente:r,servicio:l,tecnico:c._id,pago_tecnico:o,show_pago_tecnico:s}),e.props.setServiceDetails({isEditing:!0,data:a.data.details})}).catch(function(a){return 404===a.response.status?e.setState({notFound:!0}):G.toast.warn("No se puede mostrar la informaci\xf3n - "+a)}))}},{key:"render",value:function(){var e=this.state,a=e.cliente,t=e.servicio,n=e.tecnicos,r=e.tecnico,c=e.notFound,o=e.isEditing,s=e.pago_tecnico,i=e.show_pago_tecnico;return c?l.a.createElement(ae,null):l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,!0===o?"Editar":"Crear"," servicio | ",X)),l.a.createElement("form",{onSubmit:this.onSubmit},l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("h2",null,l.a.createElement("span",null,!0===o?"Editar":"Nuevo"," "),"servicio")),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("button",{id:"btn_send",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," backup ")," ",l.a.createElement("span",null,!0===o?"Guardar":"Crear"))))),l.a.createElement("div",{className:"form-content"},l.a.createElement("div",{className:"row"},!1===o?l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement(Se,{updateCliente:this.updateCliente,updateClientesStatus:this.updateClientesStatus}),l.a.createElement("small",{className:"form-text text-muted"},"Busqueda por nombre"))):null,l.a.createElement("div",{className:"col-sm-5",hidden:o},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("select",{onChange:this.onChange,value:t,name:"servicio",className:"form-control form-control frm_field",required:!0,disabled:o},he.a.map(function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.descripcion)})),l.a.createElement("small",{className:"form-text text-muted"},"Tipo de servicio"))),!1===o?l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{disabled:!0,type:"text",className:"form-control form-control frm_field",value:a&&a.telefono?a.telefono:""}),l.a.createElement("small",{className:"form-text text-muted"},"N\xfamero tel\xe9fonico"))):null,!1===o?l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{disabled:!0,type:"text",className:"form-control form-control frm_field",value:a&&a.direccion?a.direccion:""}),l.a.createElement("small",{className:"form-text text-muted"},"Direcci\xf3n"))):null,!1===o?l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{disabled:!0,type:"text",className:"form-control form-control frm_field",value:a?a.comunidad?a.comunidad+", "+a.ciudad:a.ciudad:""}),l.a.createElement("small",{className:"form-text text-muted"},"Localidad / Ciudad"))):null,l.a.createElement("div",{className:"col-sm-7"},"0"===he.a[t].id?l.a.createElement(Ye,null):"1"===he.a[t].id?l.a.createElement(Fe,null):"2"===he.a[t].id?l.a.createElement(ze,null):"3"===he.a[t].id?l.a.createElement(ze,null):null),l.a.createElement("div",{className:!0===i?"col-sm-3":"col-sm-5"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("select",{className:"form-control form-control frm_field",value:r,onChange:this.onChange,name:"tecnico",required:!0},n.map(function(e){return l.a.createElement("option",{key:e._id,value:e._id},e.nombre)})),l.a.createElement("small",{className:"form-text text-muted"},"T\xe9cnico"))),!0===i?l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{type:"number",className:"form-control form-control frm_field",min:"1",value:s,name:"pago_tecnico",onChange:this.onChange}),l.a.createElement("small",{className:"form-text text-muted"},"Pago al t\xe9cnico"))):null))))}}]),a}(r.Component),Ue={setServiceDetails:_},He=Object(ee.a)(Object(v.b)(function(e){return{serviceData:e.serviceDetails}},Ue)(Ve)),Be=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).delete=function(){var e=t.props.session.user.permisos,a=t.state,n=a._id,r=a.tipo;W.a.prompt("Confirma la eliminaci\xf3n","Ingresa ".concat(0===e?"tu contrase\xf1a":"una contrase\xf1a de administrador"," para eliminar el servicio"),"",function(a,l){k.a.post("/api/servicios/eliminar",{password:l,id:n,type:r}).then(function(a){G.toast.info("Se elimin\xf3 el servicio".concat(0===e?".":" con autorizaci\xf3n de "+a.data.admin)),t.props.history.push("/servicios")}).catch(function(a){return 401===a.response.status?G.toast.warn("La contrase\xf1a".concat(0===e?"":" de administrador"," es incorrecta.")):G.toast.error("No se pudo eliminar el servicio - "+a)})},function(){}).set("type","password").set("labels",{ok:"Aceptar",cancel:"Cancelar"})},t.reagendar=function(){W.a.prompt("Cliente ausente","Ingresa la fecha de la pr\xf3xima visita","",function(e,a){var n=be.a.utc().startOf("day").format(),r=be.a.utc(a).startOf("day").format();if("Invalid date"!==r){var l=t.state._id;k.a.post("/api/servicios/reagendar",{_id:l,fecha:n,nuevaFecha:r}).then(function(e){if(e||e.data){var a=e.data,n=a.fechaTentativa,r=a.fechaReagendado;return t.setState({fechaTentativa:n,fechaReagendado:r}),G.toast.info("Se reagend\xf3 la visita")}}).catch(function(e){return e.response&&404===e.response.status?G.toast.error("El servicio no existe"):e.response&&401===e.response.status?G.toast.error("No puedes realizar esta acci\xf3n porque el servicio ya se concluy\xf3"):G.toast.error("No se guardar la informaci\xf3n - "+e)})}},function(){}).set("type","date").set("labels",{ok:"Aceptar",cancel:"Cancelar"})},t.state={notFound:!1,_id:"",sc:!0,cliente:{},tipo:"",tecnico:"",costo:"",mastil:"",material:"",netflix:!1,paquete:"",sector:"",tipoPago:"",fechaSolicitud:void 0,fechaTentativa:void 0,fechaReagendado:void 0,fechaConclusion:void 0,image:void 0},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props.match.params.id;a&&k.a.get("/api/servicios/detallar/"+a).then(function(a){if(a.data){var t=a.data.details,n=t.costo,r=t.mastil,l=t.material,c=t.netflix,o=t.paquete,s=t.sector,i=t.tipoPago,m=a.data.service,u=m._id,d=m.cliente,p=m.tipo,f=m.tecnico,E=m.sc,v=m.fechaSolicitud,h=m.fechaTentativa,N=m.fechaConclusion,b=m.fechaReagendado,g=m.image;e.setState({_id:u,sc:E,cliente:d,tipo:p,tecnico:f.nombre,costo:n,mastil:r,material:l,netflix:c,paquete:o,sector:s,tipoPago:i,fechaSolicitud:v,fechaTentativa:h,fechaReagendado:b,fechaConclusion:N,image:g})}}).catch(function(a){return 404===a.response.status?e.setState({notFound:!0}):G.toast.warn("No se puede mostrar la informaci\xf3n - "+a)})}},{key:"render",value:function(){var e=this.state,a=e._id,t=e.sc,n=e.cliente,r=e.tecnico,c=e.tipo,o=e.costo,s=e.mastil,i=e.material,m=e.netflix,u=e.paquete,d=e.sector,p=e.tipoPago,f=e.notFound,E=e.fechaSolicitud,v=e.fechaTentativa,h=e.fechaConclusion,N=e.fechaReagendado,b=e.image,g=this.props.session.user.permisos,x=he.a.filter(function(e){return e.id===c})[0],y=we.a.filter(function(e){return e.id===u})[0],C=ke.a.filter(function(e){return e.id===p})[0];return f?l.a.createElement(ae,null):l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Detalle de servicio | ",X)),l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("h2",null,l.a.createElement("span",null,"Vista previa de "),"servicio")),l.a.createElement("div",{className:"col-sm-8"},2!==g?l.a.createElement("button",{onClick:this.delete,className:"btn btn-danger"},l.a.createElement("i",{className:"material-icons"}," delete ")," ",l.a.createElement("span",null,"Borrar")):null,b?l.a.createElement("a",{className:"btn btn-info",href:"/api/photo/"+b,"data-fancybox":!0},l.a.createElement("i",{className:"material-icons"}," photo ")," ",l.a.createElement("span",null,"Evidencia")):null,!1===t&&2!==g?l.a.createElement(L.a,{to:"/servicios/editar/"+a,className:"btn btn-info"},l.a.createElement("i",{className:"material-icons"}," edit ")," ",l.a.createElement("span",null,"Editar")):null,!1===t?l.a.createElement(L.a,{to:"/servicios/"+c+"/visita/"+a,className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," done_all ")," ",l.a.createElement("span",null,"Finalizar servicio")):null,!1===t?l.a.createElement("button",{onClick:this.reagendar,className:"btn btn-secondary"},l.a.createElement("i",{className:"material-icons"}," close ")," ",l.a.createElement("span",null,"Ausente")):null))),!0===t?l.a.createElement("span",{className:"badge badge-success"},"Finalizado el ",be()(h,"YYYYMMDD").local().format("DD [de] MMMM [de] YYYY")||""):l.a.createElement("span",{className:"badge badge-warning"},"Pendiente"),l.a.createElement("span",{className:"badge badge-primary"},"Solicitado el ",be()(E,"YYYYMMDD").local().format("DD [de] MMMM [de] YYYY")||""),N?l.a.createElement("span",{className:"badge badge-info"},"Re-agendado el ",be()(N,"YYYYMMDD").local().format("DD [de] MMMM [de] YYYY")||""):null,l.a.createElement("span",{className:"badge badge-secondary"},"Vencimiento el ",be()(v,"YYYYMMDD").local().format("DD [de] MMMM [de] YYYY")||""),l.a.createElement("div",{className:"form-content",style:{marginTop:"20px"}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:n.nombre||"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Nombre"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:x?x.descripcion:"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Tipo de servicio"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:n.telefono||"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"N\xfamero tel\xe9fonico"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:n.direccion||"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Direcci\xf3n"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",readOnly:!0,className:"form-control form-control frm_field",value:(n.comunidad?n.comunidad+", "+n.ciudad:n.ciudad)||""}),l.a.createElement("small",{className:"form-text text-muted"},"Localidad / Ciudad"))),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:y?y.nombre:"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Tipo de paquete"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:o,readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Costo de inst."))),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:!0===m?"S\xed":"No",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Netflix"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:C?C.nombre:"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Forma de pago"))))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:r||"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"T\xe9cnico"))),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("textarea",{value:i||"",readOnly:!0,style:{height:"123px"},type:"text",className:"form-control form-control frm_field",name:"material",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"Material utilizado"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{value:s||"",readOnly:!0,type:"text",required:!0,className:"form-control form-control frm_field",name:"mastil"}),l.a.createElement("small",{className:"form-text text-muted"},"M\xe1stil"))),l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{value:d||"",readOnly:!0,type:"text",required:!0,className:"form-control form-control frm_field",name:"sector"}),l.a.createElement("small",{className:"form-text text-muted"},"Sector"))))))))}}]),a}(r.Component),We=Object(ee.a)(Object(v.b)(function(e){return{session:e.session}})(Be)),Ge=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).delete=function(){var e=t.props.session.user.permisos,a=t.state,n=a._id,r=a.tipo;W.a.prompt("Confirma la eliminaci\xf3n","Ingresa ".concat(0===e?"tu contrase\xf1a":"una contrase\xf1a de administrador"," para eliminar el servicio"),"",function(a,l){k.a.post("/api/servicios/eliminar",{password:l,id:n,type:r}).then(function(a){G.toast.info("Se elimin\xf3 el servicio".concat(0===e?".":" con autorizaci\xf3n de "+a.data.admin)),t.props.history.push("/servicios")}).catch(function(a){return 401===a.response.status?G.toast.warn("La contrase\xf1a".concat(0===e?"":" de administrador"," es incorrecta.")):G.toast.error("No se pudo eliminar el servicio - "+a)})},function(){}).set("type","password").set("labels",{ok:"Aceptar",cancel:"Cancelar"})},t.reagendar=function(){W.a.prompt("Cliente ausente","Ingresa la fecha de la pr\xf3xima visita","",function(e,a){var n=be.a.utc().startOf("day").format(),r=be.a.utc(a).startOf("day").format();if("Invalid date"!==r){var l=t.state._id;k.a.post("/api/servicios/reagendar",{_id:l,fecha:n,nuevaFecha:r}).then(function(e){if(e||e.data){var a=e.data,n=a.fechaTentativa,r=a.fechaReagendado;return t.setState({fechaTentativa:n,fechaReagendado:r}),G.toast.info("Se reagend\xf3 la visita")}}).catch(function(e){return e.response&&404===e.response.status?G.toast.error("El servicio no existe"):e.response&&401===e.response.status?G.toast.error("No puedes realizar esta acci\xf3n porque el servicio ya se concluy\xf3"):G.toast.error("No se guardar la informaci\xf3n - "+e)})}},function(){}).set("type","date").set("labels",{ok:"Aceptar",cancel:"Cancelar"})},t.state={notFound:!1,_id:"",sc:!0,cliente:{},tipo:"",tecnico:"",camaras:"",costo:"",mastil:"",material:"",sector:"",tipoPago:"",fechaSolicitud:void 0,fechaTentativa:void 0,fechaReagendado:void 0,fechaConclusion:void 0,image:void 0},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props.match.params.id;a&&k.a.get("/api/servicios/detallar/"+a).then(function(a){if(a.data){console.log(a.data);var t=a.data.details,n=t.costo,r=t.mastil,l=t.material,c=t.camaras,o=t.sector,s=t.tipoPago,i=a.data.service,m=i._id,u=i.cliente,d=i.tipo,p=i.tecnico,f=i.sc,E=i.fechaSolicitud,v=i.fechaTentativa,h=i.fechaConclusion,N=i.fechaReagendado,b=i.image;e.setState({_id:m,sc:f,cliente:u,tipo:d,tecnico:p.nombre,costo:n,mastil:r,material:l,camaras:c,sector:o,tipoPago:s,fechaSolicitud:E,fechaTentativa:v,fechaReagendado:N,fechaConclusion:h,image:b})}}).catch(function(a){return 404===a.response.status?e.setState({notFound:!0}):G.toast.warn("No se puede mostrar la informaci\xf3n - "+a)})}},{key:"render",value:function(){var e=this.state,a=e._id,t=e.sc,n=e.cliente,r=e.tecnico,c=e.tipo,o=e.costo,s=e.mastil,i=e.material,m=e.camaras,u=e.sector,d=e.tipoPago,p=e.notFound,f=e.fechaSolicitud,E=e.fechaTentativa,v=e.fechaConclusion,h=e.fechaReagendado,N=e.image,b=this.props.session.user.permisos,g=he.a.filter(function(e){return e.id===c})[0],x=ke.a.filter(function(e){return e.id===d})[0];return p?l.a.createElement(ae,null):l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Detalle de servicio | ",X)),l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("h2",null,l.a.createElement("span",null,"Vista previa de "),"servicio")),l.a.createElement("div",{className:"col-sm-8"},2!==b?l.a.createElement("button",{onClick:this.delete,className:"btn btn-danger"},l.a.createElement("i",{className:"material-icons"}," delete ")," ",l.a.createElement("span",null,"Borrar")):null,N?l.a.createElement("a",{className:"btn btn-info",href:"/api/photo/"+N,"data-fancybox":!0},l.a.createElement("i",{className:"material-icons"}," photo ")," ",l.a.createElement("span",null,"Evidencia")):null,!1===t&&2!==b?l.a.createElement(L.a,{to:"/servicios/editar/"+a,className:"btn btn-info"},l.a.createElement("i",{className:"material-icons"}," edit ")," ",l.a.createElement("span",null,"Editar")):null,!1===t?l.a.createElement(L.a,{to:"/servicios/"+c+"/visita/"+a,className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," done_all ")," ",l.a.createElement("span",null,"Finalizar servicio")):null,!1===t?l.a.createElement("button",{onClick:this.reagendar,className:"btn btn-secondary"},l.a.createElement("i",{className:"material-icons"}," close ")," ",l.a.createElement("span",null,"Ausente")):null))),!0===t?l.a.createElement("span",{className:"badge badge-success"},"Finalizado el ",be()(v,"YYYYMMDD").local().format("DD [de] MMMM [de] YYYY")||""):l.a.createElement("span",{className:"badge badge-warning"},"Pendiente"),l.a.createElement("span",{className:"badge badge-primary"},"Solicitado el ",be()(f,"YYYYMMDD").local().format("DD [de] MMMM [de] YYYY")||""),h?l.a.createElement("span",{className:"badge badge-info"},"Re-agendado el ",be()(h,"YYYYMMDD").local().format("DD [de] MMMM [de] YYYY")||""):null,l.a.createElement("span",{className:"badge badge-secondary"},"Vencimiento el ",be()(E,"YYYYMMDD").local().format("DD [de] MMMM [de] YYYY")||""),l.a.createElement("div",{className:"form-content",style:{marginTop:"20px"}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:n.nombre||"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Nombre"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:g?g.descripcion:"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Tipo de servicio"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:n.telefono||"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"N\xfamero tel\xe9fonico"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:n.direccion||"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Direcci\xf3n"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",readOnly:!0,className:"form-control form-control frm_field",value:(n.comunidad?n.comunidad+", "+n.ciudad:n.ciudad)||""}),l.a.createElement("small",{className:"form-text text-muted"},"Localidad / Ciudad"))),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:m,readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"C\xe1maras"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:o,readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Costo de instalaci\xf3n"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:x?x.nombre:"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Forma de pago"))))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:r||"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"T\xe9cnico"))),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("textarea",{value:i||"",readOnly:!0,style:{height:"123px"},type:"text",className:"form-control form-control frm_field",name:"material",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"Material utilizado"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{value:s||"",readOnly:!0,type:"text",required:!0,className:"form-control form-control frm_field",name:"mastil"}),l.a.createElement("small",{className:"form-text text-muted"},"M\xe1stil"))),l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{value:u||"",readOnly:!0,type:"text",required:!0,className:"form-control form-control frm_field",name:"sector"}),l.a.createElement("small",{className:"form-text text-muted"},"Sector"))))))))}}]),a}(r.Component),$e=Object(ee.a)(Object(v.b)(function(e){return{session:e.session}})(Ge)),Xe=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).delete=function(){var e=t.props.session.user.permisos,a=t.state,n=a._id,r=a.tipo;W.a.prompt("Confirma la eliminaci\xf3n","Ingresa ".concat(0===e?"tu contrase\xf1a":"una contrase\xf1a de administrador"," para eliminar el servicio"),"",function(a,l){k.a.post("/api/servicios/eliminar",{password:l,id:n,type:r}).then(function(a){G.toast.info("Se elimin\xf3 el servicio".concat(0===e?".":" con autorizaci\xf3n de "+a.data.admin)),t.props.history.push("/servicios")}).catch(function(a){return 401===a.response.status?G.toast.warn("La contrase\xf1a".concat(0===e?"":" de administrador"," es incorrecta.")):G.toast.error("No se pudo eliminar el servicio - "+a)})},function(){}).set("type","password").set("labels",{ok:"Aceptar",cancel:"Cancelar"})},t.reagendar=function(){W.a.prompt("Cliente ausente","Ingresa la fecha de la pr\xf3xima visita","",function(e,a){var n=be.a.utc().startOf("day").format(),r=be.a.utc(a).startOf("day").format();if("Invalid date"!==r){var l=t.state._id;k.a.post("/api/servicios/reagendar",{_id:l,fecha:n,nuevaFecha:r}).then(function(e){if(e||e.data){var a=e.data,n=a.fechaTentativa,r=a.fechaReagendado;return t.setState({fechaTentativa:n,fechaReagendado:r}),G.toast.info("Se reagend\xf3 la visita")}}).catch(function(e){return e.response&&404===e.response.status?G.toast.error("El servicio no existe"):e.response&&401===e.response.status?G.toast.error("No puedes realizar esta acci\xf3n porque el servicio ya se concluy\xf3"):G.toast.error("No se guardar la informaci\xf3n - "+e)})}},function(){}).set("type","date").set("labels",{ok:"Aceptar",cancel:"Cancelar"})},t.state={_id:"",sc:!0,cliente:{},tecnico:"",tipo:"",problema:"",problemaReal:"",notFound:!1,fechaSolicitud:void 0,fechaTentativa:void 0,fechaReagendado:void 0,fechaConclusion:void 0,image:void 0},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props.match.params.id;a&&k.a.get("/api/servicios/detallar/"+a).then(function(a){if(a.data){var t=a.data.details,n=t.problema,r=t.problemaReal,l=a.data.service,c=l._id,o=l.cliente,s=l.tipo,i=l.tecnico,m=l.sc,u=l.fechaSolicitud,d=l.fechaTentativa,p=l.fechaConclusion,f=l.fechaReagendado,E=l.image;e.setState({_id:c,sc:m,cliente:o,tecnico:i.nombre,tipo:s,problema:n,problemaReal:r,fechaSolicitud:u,fechaTentativa:d,fechaReagendado:f,fechaConclusion:p,image:E})}}).catch(function(a){return 404===a.response.status?e.setState({notFound:!0}):G.toast.warn("No se puede mostrar la informaci\xf3n - "+a)})}},{key:"render",value:function(){var e=this.state,a=e._id,t=e.sc,n=e.cliente,r=e.tecnico,c=e.tipo,o=e.problema,s=e.problemaReal,i=e.notFound,m=e.fechaSolicitud,u=e.fechaTentativa,d=e.fechaConclusion,p=e.fechaReagendado,f=e.image,E=this.props.session.user.permisos,v=he.a.filter(function(e){return e.id===c})[0];return i?l.a.createElement(ae,null):l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Detalle de servicio | ",X)),l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("h2",null,l.a.createElement("span",null,"Vista previa de "),"servicio")),l.a.createElement("div",{className:"col-sm-8"},2!==E?l.a.createElement("button",{onClick:this.delete,className:"btn btn-danger"},l.a.createElement("i",{className:"material-icons"}," delete ")," ",l.a.createElement("span",null,"Borrar")):null,f?l.a.createElement("a",{className:"btn btn-info",href:"/api/photo/"+f,"data-fancybox":!0},l.a.createElement("i",{className:"material-icons"}," photo ")," ",l.a.createElement("span",null,"Evidencia")):null,!1===t&&2!==E?l.a.createElement(L.a,{to:"/servicios/editar/"+a,className:"btn btn-info"},l.a.createElement("i",{className:"material-icons"}," edit ")," ",l.a.createElement("span",null,"Editar")):null,!1===t?l.a.createElement(L.a,{to:"/servicios/"+c+"/visita/"+a,className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," done_all ")," ",l.a.createElement("span",null,"Finalizar servicio")):null,!1===t?l.a.createElement("button",{onClick:this.reagendar,className:"btn btn-secondary"},l.a.createElement("i",{className:"material-icons"}," close ")," ",l.a.createElement("span",null,"Ausente")):null))),!0===t?l.a.createElement("span",{className:"badge badge-success"},"Finalizado el ",be()(d,"YYYYMMDD").local().format("DD [de] MMMM [de] YYYY")||""):l.a.createElement("span",{className:"badge badge-warning"},"Pendiente"),l.a.createElement("span",{className:"badge badge-primary"},"Solicitado el ",be()(m,"YYYYMMDD").local().format("DD [de] MMMM [de] YYYY")||""),p?l.a.createElement("span",{className:"badge badge-info"},"Re-agendado el ",be()(p,"YYYYMMDD").local().format("DD [de] MMMM [de] YYYY")||""):null,l.a.createElement("span",{className:"badge badge-secondary"},"Vencimiento el ",be()(u,"YYYYMMDD").local().format("DD [de] MMMM [de] YYYY")||""),l.a.createElement("div",{className:"form-content",style:{marginTop:"20px"}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:n.nombre||"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Nombre"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:v?v.descripcion:"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Tipo de servicio"))),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:n.telefono||"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"N\xfamero tel\xe9fonico"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:n.direccion||"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Direcci\xf3n"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",readOnly:!0,className:"form-control form-control frm_field",value:(n.comunidad?n.comunidad+", "+n.ciudad:n.ciudad)||""}),l.a.createElement("small",{className:"form-text text-muted"},"Localidad / Ciudad"))),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:o,readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Problema reportado"))),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{type:"text",value:r||"",readOnly:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"T\xe9cnico"))),l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{value:s,readOnly:!0,type:"text",required:!0,className:"form-control form-control frm_field"}),l.a.createElement("small",{className:"form-text text-muted"},"Problema real"))))))}}]),a}(r.Component),Je=Object(ee.a)(Object(v.b)(function(e){return{session:e.session}})(Xe));be.a.locale("es");var Ke=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).onChange=function(e){var a=e.target,n=a.name,r=a.value;t.setState(Object(Z.a)({},n,r))},t.onSubmit=function(e){e.preventDefault();var a=t.props.match.params.id;if(a){var n=new FormData,r=document.querySelector('input[type="file"]');if(r.files&&r.files[0]){var l=r.files[0];n.append("picture",l)}var c=be()().startOf("day").format(),o=t.state,s=o.material,i=o.mastil,m=o.sector;n.set("id",a),n.set("material",s),n.set("mastil",i),n.set("sector",m),n.set("fecha",c),k()({method:"post",url:"/api/servicios/0/visita",data:n,config:{headers:{"Content-Type":"multipart/form-data"}}}).then(function(e){if(e.status&&200===e.status)return t.props.history.replace("/servicios/"+e.data.tipo+"/ver/"+e.data._id),G.toast.success("Se guard\xf3 la informaci\xf3n")}).catch(function(e){return e.response&&404===e.response.status?G.toast.warn("El registro que intentas modificar no existe"):e.response&&401===e.response.status?G.toast.warn("No se puede realizar la acci\xf3n porque el servicio ya se finaliz\xf3"):void G.toast.error("No se puede realizar la acci\xf3n - "+e)})}},t.updateImgLabel=function(){var e=document.querySelector('input[type="file"]'),a="";e.files&&e.files[0]&&(a=e.files[0].name.substring(0,28));t.setState({textoImagen:a})},t.state={material:"",mastil:"",sector:"",textoImagen:""},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=this.state,a=e.material,t=e.mastil,n=e.sector,r=e.textoImagen;return l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Finalizar servicio | ",X)),l.a.createElement("form",{onSubmit:this.onSubmit},l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("h2",null,l.a.createElement("span",null,"Finalizar "),"servicio")),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("button",{type:"submit",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," backup ")," ",l.a.createElement("span",null,"Finalizar"))))),l.a.createElement("div",{className:"form-content"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("textarea",{rows:"4",onChange:this.onChange,value:a,type:"text",className:"form-control form-control frm_field",placeholder:"Materiales",name:"material",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"Material utilizado"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{onChange:this.onChange,value:t,type:"text",required:!0,className:"form-control form-control frm_field",placeholder:"M\xe1stil",name:"mastil"}),l.a.createElement("small",{className:"form-text text-muted"},"M\xe1stil"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{onChange:this.onChange,value:n,type:"text",required:!0,className:"form-control form-control frm_field",placeholder:"Sector",name:"sector"}),l.a.createElement("small",{className:"form-text text-muted"},"Sector"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"custom-file form-group mb-4"},l.a.createElement("input",{onChange:this.updateImgLabel,type:"file",className:"custom-file-input frm_field",name:"picture",accept:"image/*"}),l.a.createElement("label",{className:"custom-file-label frm_video"},r||"Evidencia opcional"),l.a.createElement("small",{className:"form-text text-muted"},"Selecciona un archivo")))))))}}]),a}(r.Component),Qe=Object(ee.a)(Ke);be.a.locale("es");var Ze=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).onChange=function(e){var a=e.target,n=a.name,r=a.value;t.setState(Object(Z.a)({},n,r))},t.onSubmit=function(e){e.preventDefault();var a=t.props.match.params.id;if(a){var n=new FormData,r=document.querySelector('input[type="file"]');if(r.files&&r.files[0]){var l=r.files[0];n.append("picture",l)}var c=be()().startOf("day").format(),o=t.state,s=o.material,i=o.mastil,m=o.sector;n.set("id",a),n.set("material",s),n.set("mastil",i),n.set("sector",m),n.set("fecha",c),k()({method:"post",url:"/api/servicios/1/visita",data:n,config:{headers:{"Content-Type":"multipart/form-data"}}}).then(function(e){if(e.status&&200===e.status)return t.props.history.replace("/servicios/"+e.data.tipo+"/ver/"+e.data._id),G.toast.success("Se guard\xf3 la informaci\xf3n")}).catch(function(e){return e.response&&404===e.response.status?G.toast.warn("El registro que intentas modificar no existe"):e.response&&401===e.response.status?G.toast.warn("No se puede realizar la acci\xf3n porque el servicio ya se finaliz\xf3"):void G.toast.error("No se puede realizar la acci\xf3n - "+e)})}},t.updateImgLabel=function(){var e=document.querySelector('input[type="file"]'),a="";e.files&&e.files[0]&&(a=e.files[0].name.substring(0,28));t.setState({textoImagen:a})},t.state={material:"",mastil:"",sector:"",textoImagen:""},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=this.state,a=e.material,t=e.mastil,n=e.sector,r=e.textoImagen;return l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Finalizar servicio | ",X)),l.a.createElement("form",{onSubmit:this.onSubmit},l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("h2",null,l.a.createElement("span",null,"Finalizar "),"servicio")),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("button",{type:"submit",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," backup ")," ",l.a.createElement("span",null,"Finalizar"))))),l.a.createElement("div",{className:"form-content"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("textarea",{rows:"4",onChange:this.onChange,value:a,type:"text",className:"form-control form-control frm_field",placeholder:"Materiales",name:"material",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"* Material utilizado"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{onChange:this.onChange,value:t,type:"text",required:!0,className:"form-control form-control frm_field",placeholder:"M\xe1stil",name:"mastil"}),l.a.createElement("small",{className:"form-text text-muted"},"* M\xe1stil"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{onChange:this.onChange,value:n,type:"text",required:!0,className:"form-control form-control frm_field",placeholder:"Sector",name:"sector"}),l.a.createElement("small",{className:"form-text text-muted"},"* Sector"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"custom-file form-group mb-4"},l.a.createElement("input",{onChange:this.updateImgLabel,type:"file",className:"custom-file-input frm_field",name:"picture",accept:"image/*"}),l.a.createElement("label",{className:"custom-file-label frm_video"},r||"Evidencia opcional"),l.a.createElement("small",{className:"form-text text-muted"},"Selecciona un archivo")))))))}}]),a}(r.Component),ea=Object(ee.a)(Ze);be.a.locale("es");var aa=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).onChange=function(e){var a=e.target,n=a.name,r=a.value;t.setState(Object(Z.a)({},n,r))},t.onSubmit=function(e){e.preventDefault();var a=t.props.match.params.id;if(a){var n,r=new FormData,l=document.querySelector('input[type="file"]');if(l.files&&l.files[0]){var c=l.files[0];r.append("picture",c)}"/servicios/2/visita/:id"===t.props.match.path?n=2:"/servicios/3/visita/:id"===t.props.match.path&&(n=3);var o=be()().startOf("day").format(),s=t.state.problemaReal;r.set("id",a),r.set("problemaReal",s),r.set("fecha",o),k()({method:"post",url:"/api/servicios/"+n+"/visita",data:r,config:{headers:{"Content-Type":"multipart/form-data"}}}).then(function(e){if(e.status&&200===e.status)return t.props.history.replace("/servicios/"+e.data.tipo+"/ver/"+e.data._id),G.toast.success("Se guard\xf3 la informaci\xf3n")}).catch(function(e){return e.response&&404===e.response.status?G.toast.warn("El registro que intentas modificar no existe"):e.response&&401===e.response.status?G.toast.warn("No se puede realizar la acci\xf3n porque el servicio ya se finaliz\xf3"):void G.toast.error("No se puede realizar la acci\xf3n - "+e)})}},t.updateImgLabel=function(){var e=document.querySelector('input[type="file"]'),a="";e.files&&e.files[0]&&(a=e.files[0].name),t.setState({textoImagen:a})},t.state={problemaReal:"",textoImagen:""},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=this.state,a=e.problemaReal,t=e.textoImagen;return l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Finalizar servicio | ",X)),l.a.createElement("form",{onSubmit:this.onSubmit},l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("h2",null,l.a.createElement("span",null,"Finalizar "),"servicio")),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("button",{type:"submit",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," backup ")," ",l.a.createElement("span",null,"Finalizar"))))),l.a.createElement("div",{className:"form-content"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("textarea",{rows:"4",onChange:this.onChange,value:a,type:"text",className:"form-control form-control frm_field",placeholder:"Problema",name:"problemaReal",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"Problema real"))),l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("div",{className:"custom-file form-group mb-2"},l.a.createElement("input",{onChange:this.updateImgLabel,type:"file",className:"custom-file-input frm_field",name:"picture",accept:"image/*"}),l.a.createElement("label",{className:"custom-file-label frm_video"},t||"Evidencia opcional"),l.a.createElement("small",{className:"form-text text-muted"},"Selecciona un archivo")))))))}}]),a}(r.Component),ta=Object(ee.a)(aa),na=(t(124),function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).state={internet:[]},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){this.requestData()}},{key:"requestData",value:function(){var e=this;k.a.get("/api/servicios/internet/listar").then(function(a){if(a.data){var t=a.data;e.setState({internet:t})}}).catch(function(e){return G.toast.warn("No se puede mostrar la informaci\xf3n - "+e)})}},{key:"changeStatus",value:function(e,a){var t=this,n=a?"SUSPENDIDO":"ACTIVO";W.a.confirm("Confirma el cambio","Se cambiar\xe1 el estado a "+n+", \xbfEst\xe1 seguro?",function(a,n){k.a.post("/api/servicios/internet/change_status",{_id:e}).then(function(a){if(200===a.status){var n=t.state.internet.map(function(a){return a._id===e?(a.internetActivo=!a.internetActivo,a):a});return t.setState({internet:n}),G.toast.info("Se actualiz\xf3 el status.")}}).catch(function(e){return G.toast.error("No se pudo cambiar el status - "+e)})},function(){}).set("labels",{ok:"Aceptar",cancel:"Cancelar"})}},{key:"render",value:function(){var e=this,a=this.state.internet;return l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Usuarios | ",X)),l.a.createElement("div",{className:"header",style:{marginBottom:"0px"}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("h2",null,l.a.createElement("span",null,"Usuarios de Internet "))))),l.a.createElement("table",{className:"table"},l.a.createElement("thead",{className:"thead-light"},l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"Nombre"),l.a.createElement("th",{scope:"col"},"Tel\xe9fono"),l.a.createElement("th",{scope:"col"},"Direcci\xf3n"),l.a.createElement("th",{scope:"col"},"Comunidad"),l.a.createElement("th",{scope:"col"},"Ciudad"),l.a.createElement("th",{scope:"col"},"Ver"),l.a.createElement("th",{scope:"col"},"Estado"),l.a.createElement("th",{scope:"col"},"Cambiar"))),l.a.createElement("tbody",null,a.map(function(a){var t=a._id,n=a.internetActivo,r=a.servicio.cliente,c=r.nombre,o=r.telefono,s=r.direccion,i=r.comunidad,m=r.ciudad;return l.a.createElement("tr",{key:t},l.a.createElement("td",null,c),l.a.createElement("td",null,o),l.a.createElement("td",null,s),l.a.createElement("td",null,i),l.a.createElement("td",null,m),l.a.createElement("td",null,l.a.createElement(L.a,{to:"/servicios/0/ver/"+a.servicio._id},l.a.createElement("i",{className:"material-icons"}," remove_red_eye "))),l.a.createElement("td",null,l.a.createElement("i",{className:"material-icons statusIcon internet ".concat(n?"in":"ac")}," ",n?"check":"cancel"," ")),l.a.createElement("td",{onClick:function(){return e.changeStatus(t,n)}},l.a.createElement("i",{className:"material-icons"}," refresh ")))}))))}}]),a}(r.Component)),ra=t(34),la=t.n(ra),ca=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).delete=function(e,a){W.a.prompt("Confirma la eliminaci\xf3n","Ingresa tu contrase\xf1a para eliminar a "+a,"",function(a,n){k.a.post("/api/usuarios/eliminar",{password:n,_id:e}).then(function(e){G.toast.info("Se elimin\xf3 el usuario"),t.requestData()}).catch(function(e){return e.response&&404===e.response.status?G.toast.warn("La contrase\xf1a es incorrecta."):e.response&&302===e.response.status?G.toast.warn("No se puede eliminar al usuario porque tiene servicios relacionados"):e.response&&204===e.response.status?G.toast.warn("No se econtr\xf3 al usuario"):e.response&&304===e.response.status?G.toast.warn("No se puede eliminar a todos los administradores"):G.toast.error("No se pudo eliminar el cliente - "+e)})},function(){}).set("type","password").set("labels",{ok:"Aceptar",cancel:"Cancelar"})},t.resetPayment=function(e){W.a.confirm("Confirma el pago","Se reiniciar\xe1 el contador a $0 para este t\xe9cnico, \xbfEst\xe1 seguro?",function(a,n){k.a.post("/api/usuarios/reset_payment",{_id:e}).then(function(a){var n=t.state.usuarios.map(function(a){return a._id===e?(a.pago=0,a):a});return t.setState({usuarios:n}),G.toast.info("Se reinici\xf3 el contador de pago")}).catch(function(e){return G.toast.error("No se pudo reiniciar el pago - "+e)})},function(){}).set("labels",{ok:"Aceptar",cancel:"Cancelar"})},t.state={usuarios:[]},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){this.requestData()}},{key:"requestData",value:function(){var e=this;k.a.get("/api/usuarios/listar").then(function(a){if(a.data){var t=a.data;console.log(t),e.setState({usuarios:t})}}).catch(function(e){return G.toast.warn("No se puede mostrar la informaci\xf3n - "+e)})}},{key:"render",value:function(){var e=this,a=this.state.usuarios;return l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Usuarios | ",X)),l.a.createElement("div",{className:"header",style:{marginBottom:"0px"}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("h2",null,l.a.createElement("span",null,"Usuarios "))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement(L.a,{to:"/usuarios/crear",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," add ")," ",l.a.createElement("span",null,"Agregar"))))),l.a.createElement("table",{className:"table"},l.a.createElement("thead",{className:"thead-light"},l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"Nombre"),l.a.createElement("th",{scope:"col"},"Usuario"),l.a.createElement("th",{scope:"col"},"Permisos"),l.a.createElement("th",{scope:"col"},"Pago servicios"),l.a.createElement("th",{scope:"col"},"Pagar"),l.a.createElement("th",{scope:"col"},"Editar"),l.a.createElement("th",{scope:"col"},"Eliminar"))),l.a.createElement("tbody",null,a.map(function(a){var t=a._id,n=a.nombre,r=a.usuario,c=a.permisos,o=a.pago,s=la.a.filter(function(e){return e.id===c})[0];return l.a.createElement("tr",{key:t},l.a.createElement("td",null,n),l.a.createElement("td",null,r),l.a.createElement("td",null,s.descripcion),l.a.createElement("td",null,3===s.id?"$"+o:null),l.a.createElement("td",{onClick:function(){return e.resetPayment(t)}},3===s.id?l.a.createElement("i",{className:"material-icons"},"money_off"):null),l.a.createElement("td",null,l.a.createElement(L.a,{to:"/usuarios/editar/"+t},l.a.createElement("i",{className:"material-icons"}," edit "))),l.a.createElement("td",{onClick:function(){return e.delete(t,n)}},l.a.createElement("i",{className:"material-icons"}," delete ")))}))))}}]),a}(r.Component),oa=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).newPassword=function(){t.setState({password:Math.random().toString(36).substr(2,8)})},t.onChange=function(e){var a=e.target,n=a.name,r=a.value;t.setState(Object(Z.a)({},n,r))},t.onSubmit=function(e){e.preventDefault();var a=t.state,n=a._id,r=a.nombre,l=a.usuario,c=a.password,o=a.permisos,s=a.isEditing;k.a.post("/"+"api/usuarios".concat(s?"/editar":"/nuevo"),{_id:n,nombre:r,usuario:l,password:c,permisos:o}).then(function(e){G.toast.success("Se ".concat(s?"edit\xf3":"cre\xf3"," el usuario ")+l),t.props.history.push("/usuarios")}).catch(function(e){if(409===e.response.status)return G.toast.warn("Ya existe el nombre de usuario "+l);G.toast.warn("No se pudo ".concat(s?"editar":"crear"," el usuario - ").concat(e))})},t.state={_id:void 0,nombre:void 0,usuario:void 0,password:void 0,permisos:0,isEditing:!1,notFound:!1},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props.match.params.id;a?(this.setState({isEditing:!0}),k.a.get("/api/usuarios/detallar/"+a).then(function(a){var t=a.data,n=t._id,r=t.nombre,l=t.usuario,c=t.permisos;e.setState({_id:n,nombre:r,usuario:l,permisos:c})}).catch(function(a){if(404===a.response.status)return e.setState({notFound:!0});G.toast.warn("No se puede mostrar la informaci\xf3n - "+a)})):this.newPassword()}},{key:"render",value:function(){var e=this.state,a=e.nombre,t=e.usuario,n=e.password,r=e.permisos,c=e.isEditing;return e.notFound?l.a.createElement(ae,null):l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,c?"Editar":"Crear "," usuario | ",X)),l.a.createElement("form",{onSubmit:this.onSubmit},l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},c?l.a.createElement("h2",null,l.a.createElement("span",null,"Editar a "),a):l.a.createElement("h2",null,l.a.createElement("span",null,"Crear "),"usuario")),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("button",{type:"submit",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," backup ")," ",l.a.createElement("span",null,c?"Guardar":"Crear"))))),l.a.createElement("div",{className:"form-content"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("div",{className:"form-group mb-4"},l.a.createElement("input",{maxLength:"35",onChange:this.onChange,value:a||"",type:"text",className:"form-control form-control frm_field",placeholder:"Nombre completo",name:"nombre",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"* Escribe el nombre del usuario"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{maxLength:"20",onChange:this.onChange,value:t||"",type:"text",required:!0,className:"form-control form-control frm_field",placeholder:"Nombre de usuario",name:"usuario"}),l.a.createElement("small",{className:"form-text text-muted"},"* N\xfameros y letras"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{value:n||"SIN CAMBIOS",style:{width:"auto",display:"inline"},disabled:!0,type:"text",required:!0,className:"form-control form-control frm_field",name:"password"}),l.a.createElement("button",{onClick:this.newPassword,style:{marginTop:"-3px",border:"none"},type:"button",className:"btn btn-primary"},c?"Reiniciar":"Generar"),l.a.createElement("small",{className:"form-text text-muted"},"Contrase\xf1a generada autom\xe1ticamente"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("select",{onChange:this.onChange,name:"permisos",className:"form-control form-control frm_field",required:!0,value:r},la.a.map(function(e){return l.a.createElement("option",{value:e.id},e.descripcion)})),l.a.createElement("small",{className:"form-text text-muted"},"* Permisos para el usuario")))))))}}]),a}(r.Component),sa=Object(ee.a)(oa),ia=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).onChange=function(e){var a=e.target,n=a.name,r=a.value;t.setState(Object(Z.a)({},n,r))},t.onSubmit=function(e){e.preventDefault();var a=t.state,n=a.old_password,r=a.new_password,l=a.conf_password,c=t.props.session.user._id;if(r!==l)return G.toast.warn("Las contrase\xf1as no coinciden");k.a.post("/api/password/new",{_id:c,old_password:n,new_password:r}).then(function(e){return t.setState({old_password:"",new_password:"",conf_password:""}),G.toast.success("Se cambi\xf3 tu contrase\xf1a")}).catch(function(e){return 400===e.response.status?G.toast.warn("La contrase\xf1a actual es incorrecta"):G.toast.warn("No se pudo cambiar tu contrase\xf1a - "+e)})},t.state={old_password:"",new_password:"",conf_password:""},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=this.state,a=e.old_password,t=e.new_password,n=e.conf_password;return l.a.createElement(J,null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Nueva contrase\xf1a | ",X)),l.a.createElement("form",{onSubmit:this.onSubmit},l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("h2",null,l.a.createElement("span",null,"Cambiar "),"contrase\xf1a")),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("button",{id:"btn_send",className:"btn btn-success"},l.a.createElement("i",{className:"material-icons"}," backup ")," ",l.a.createElement("span",null,"Actualizar"))))),l.a.createElement("div",{className:"form-content"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{value:a,onChange:this.onChange,type:"password",className:"form-control form-control frm_field",placeholder:"Contrase\xf1a actual",name:"old_password",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"Para validad tu identidad"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{value:t,onChange:this.onChange,type:"password",className:"form-control form-control frm_field",placeholder:"Nueva contrase\xf1a",name:"new_password",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"Escribe la nueva contrase\xf1a"))),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("div",{className:"form-group mb-2"},l.a.createElement("input",{value:n,onChange:this.onChange,type:"password",className:"form-control form-control frm_field",placeholder:"Confirma la contrase\xf1a",name:"conf_password",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},"Repite la contrase\xf1a")))))))}}]),a}(r.Component),ma=Object(v.b)(function(e){return{session:e.session}})(ia),ua=t(35),da=Object(v.b)(function(e){return{session:e.session}})(function(e){var a=e.component,t=e.session,n=Object(ua.a)(e,["component","session"]);return l.a.createElement(E.a,Object.assign({},n,{render:function(e){return n.permisos&&n.permisos.filter(function(e){return e===t.user.permisos}).length>0?l.a.createElement(a,e):l.a.createElement(ae,{statusCode:"401"})}}))}),pa=function(e){function a(){return Object(s.a)(this,a),Object(m.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(d.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(R,null),l.a.createElement(U,null),l.a.createElement(f.a,null,l.a.createElement(da,{permisos:[0,1],exact:!0,path:"/clientes",component:Q}),l.a.createElement(da,{permisos:[0,1],exact:!0,path:"/clientes/crear",component:ne}),l.a.createElement(da,{permisos:[0,1],exact:!0,path:"/clientes/editar/:id",component:ne}),l.a.createElement(da,{permisos:[0,1,2,3],exact:!0,path:"/servicios",component:ye}),l.a.createElement(da,{permisos:[0,1],exact:!0,path:"/servicios/crear",component:He}),l.a.createElement(da,{permisos:[0,1],exact:!0,path:"/servicios/editar/:id",component:He}),l.a.createElement(da,{permisos:[0,1,2,3],exact:!0,path:"/servicios/0/ver/:id",component:We}),l.a.createElement(da,{permisos:[0,1,2,3],exact:!0,path:"/servicios/1/ver/:id",component:$e}),l.a.createElement(da,{permisos:[0,1,2,3],exact:!0,path:"/servicios/2/ver/:id",component:Je}),l.a.createElement(da,{permisos:[0,1,2,3],exact:!0,path:"/servicios/3/ver/:id",component:Je}),l.a.createElement(da,{permisos:[0,1,2,3],exact:!0,path:"/servicios/0/visita/:id",component:Qe}),l.a.createElement(da,{permisos:[0,1,2,3],exact:!0,path:"/servicios/1/visita/:id",component:ea}),l.a.createElement(da,{permisos:[0,1,2,3],exact:!0,path:"/servicios/2/visita/:id",component:ta}),l.a.createElement(da,{permisos:[0,1,2,3],exact:!0,path:"/servicios/3/visita/:id",component:ta}),l.a.createElement(da,{permisos:[0,1],exact:!0,path:"/puntodeventa",component:le}),l.a.createElement(da,{permisos:[0,1],exact:!0,path:"/puntodeventa/crear",component:ce}),l.a.createElement(da,{permisos:[0,1],exact:!0,path:"/puntodeventa/editar/:id",component:ce}),l.a.createElement(da,{permisos:[0,1],exact:!0,path:"/fichas",component:se}),l.a.createElement(da,{permisos:[0,1],exact:!0,path:"/fichas/crear",component:Ee}),l.a.createElement(da,{permisos:[0,1],exact:!0,path:"/fichas/editar/:id",component:Ee}),l.a.createElement(da,{permisos:[0],exact:!0,path:"/usuarios",component:ca}),l.a.createElement(da,{permisos:[0],exact:!0,path:"/usuarios/crear",component:sa}),l.a.createElement(da,{permisos:[0],exact:!0,path:"/usuarios/editar/:id",component:sa}),l.a.createElement(da,{permisos:[0,1],exact:!0,path:"/internet",component:na}),l.a.createElement(da,{permisos:[0,1,2,3],exact:!0,path:"/password",component:ma}),l.a.createElement(E.a,{component:ae})))}}]),a}(r.Component),fa=(t(125),function(e){var a=be.a.utc().startOf("day").format(),t=be.a.utc().startOf("day").add(4,"days").format();k.a.post("/api/servicios/alerta",{fechaMayor:a,fechaMenor:t,_id:e}).then(function(e){if(e.data){var t=e.data,n=8e3;t.map(function(e){n+=3e3;var t=be.a.utc(e.fechaTentativa),r=parseInt(be.a.duration(t.diff(a,"days")).asDays()),l=he.a.filter(function(a){return a.id===e.tipo}),c="Tienes ".concat(r," ").concat(1===r?"d\xeda":"d\xedas"," para realizar ").concat(l[0].descripcion," en ").concat(e.cliente.comunidad?e.cliente.comunidad+", ":"").concat(e.cliente.ciudad);return 0===r&&(c="Hoy es la fecha l\xedmite de ".concat(l[0].descripcion," en ").concat(e.cliente.comunidad?e.cliente.comunidad+", ":"").concat(e.cliente.ciudad)),0===r?G.toast.error(c,{autoClose:n}):1===r||2===r?G.toast.warn(c,{autoClose:n}):G.toast.info(c,{autoClose:n})})}}).catch(function(e){return G.toast.error("No se pudo realizar la acci\xf3n - "+e)})}),Ea=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).onChange=function(e){var a=e.target,n=a.name,r=a.value;t.setState(Object(Z.a)({},n,r))},t.onSubmit=function(e){e.preventDefault();var a=t.state,n=a.usuario,r=a.password;k.a.post("/api/auth",{usuario:n,password:r}).then(function(e){if(200===e.status){var a=e.data,n=a.token,r=a.user;localStorage.setItem("jwtToken",n),Y(n),t.props.setCurrentUser(r),2===r.permisos&&fa(r._id);var l=t.getRedirectUrl(r);return l.length>0?t.props.history.push(l[0]):t.props.history.push("/404")}}).catch(function(e){if(e.response&&404===e.response.status)return G.toast.error("Credenciales inv\xe1lidas")})},t.getRedirectUrl=function(e){return A.menu.reduce(function(a,t){var n=t.items.reduce(function(a,t){return t.permisos.filter(function(a){return a===e.permisos}).length>0?[].concat(Object(H.a)(a),[t.url]):Object(H.a)(a)},[]);return[].concat(Object(H.a)(a),Object(H.a)(n))},[])},t.state={usuario:"",password:""},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentWillMount",value:function(){var e=this.props.session;if(e.isAuth){var a=this.getRedirectUrl(e.user);return a.length>0?this.props.history.push(a[0]):this.props.history.push("/404")}}},{key:"render",value:function(){var e=this.state,a=e.usuario,t=e.password;return l.a.createElement("div",null,l.a.createElement($.Helmet,null,l.a.createElement("title",null,"Login | ",X)),l.a.createElement("div",{className:"card-alternative"},l.a.createElement("div",{className:"wrap"},l.a.createElement("div",{className:"card-content"},l.a.createElement("form",{className:"login-form",onSubmit:this.onSubmit},l.a.createElement("input",{onChange:this.onChange,value:a,type:"text",placeholder:"Nombre de usuario",name:"usuario"}),l.a.createElement("input",{onChange:this.onChange,value:t,type:"password",placeholder:"Contrase\xf1a",name:"password"}),l.a.createElement("button",null,"login"))))))}}]),a}(r.Component),va={setCurrentUser:g},ha=Object(ee.a)(Object(v.b)(function(e){return{session:e.session}},va)(Ea)),Na=t(134),ba=Object(v.b)(function(e){return{session:e.session}})(function(e){var a=e.component,t=e.session,n=Object(ua.a)(e,["component","session"]);return l.a.createElement(E.a,Object.assign({},n,{render:function(e){return!0===t.isAuth?l.a.createElement(a,e):l.a.createElement(Na.a,{to:"/"})}}))});t(126),t(127),t(128);W.a.set("prompt","transition","flipx"),W.a.set("alert","transition","fade");var ga=t(62);t(129),t(130);if(Object(ga.loadProgressBar)(),localStorage.jwtToken)try{var xa=q()(localStorage.jwtToken);Y(localStorage.jwtToken),w.dispatch(g(xa.user)),k.a.post("/api/token/validate",{token:localStorage.jwtToken}).then(function(e){e.data&&e.data.user&&w.dispatch(g(e.data))}).catch(function(e){T(),w.dispatch(x())})}catch(Ca){console.log("Decoded error")}var ya=function(e){function a(){return Object(s.a)(this,a),Object(m.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=document.getElementById("ipl-progress-indicator");e&&setTimeout(function(){e.classList.add("available"),setTimeout(function(){e.outerHTML=""},2e3)},500)}},{key:"render",value:function(){return l.a.createElement(v.a,{store:w},l.a.createElement(p.a,null,l.a.createElement(f.a,null,l.a.createElement(E.a,{exact:!0,path:"/",component:ha}),l.a.createElement(ba,{component:pa}))),l.a.createElement(G.ToastContainer,{draggable:!1,pauseOnHover:!1,pauseOnFocusLoss:!1,closeOnClick:!1,autoClose:6e3}))}}]),a}(r.Component);o.a.render(l.a.createElement(ya,null),document.getElementById("root"))},17:function(e,a){e.exports=[{id:"0",descripcion:"Instalaci\xf3n de internet"},{id:"1",descripcion:"Instalaci\xf3n de c\xe1maras de seguridad"},{id:"2",descripcion:"Soporte"},{id:"3",descripcion:"Soporte Internet"}]},22:function(e,a){e.exports=[{id:"0",nombre:"Efectivo"},{id:"1",nombre:"Transferencia"}]},28:function(e){e.exports={menu:[{title:"Men\xfa principal",items:[{name:"Clientes",icon:"people",url:"/clientes",permisos:[0,1]},{name:"Servicios",icon:"settings",url:"/servicios",permisos:[0,1,2,3]},{name:"Punto de venta",icon:"store",url:"/puntodeventa",permisos:[0,1]},{name:"Fichas",icon:"list",url:"/fichas",permisos:[0,1]},{name:"Internet",icon:"language",url:"/internet",permisos:[0,1]}]},{title:"Cuenta",items:[{name:"Usuarios",icon:"people_outline",url:"/usuarios",permisos:[0]},{name:"Cambiar contrase\xf1a",icon:"security",url:"/password",permisos:[0,1,2,3]}]}]}},33:function(e,a){e.exports=[{id:"0",nombre:"B\xe1sico"},{id:"1",nombre:"Familiar"},{id:"2",nombre:"Multimedia"},{id:"3",nombre:"Premium"}]},34:function(e,a){e.exports=[{id:0,descripcion:"Administrador"},{id:1,descripcion:"Asistente"},{id:2,descripcion:"T\xe9cnico"},{id:3,descripcion:"T\xe9cnico freelance"}]},60:function(e,a,t){e.exports=t.p+"static/media/logo.a14509a1.png"},63:function(e,a,t){e.exports=t(131)},68:function(e,a,t){},92:function(e,a,t){},93:function(e,a,t){},94:function(e,a,t){}},[[63,1,2]]]);
//# sourceMappingURL=main.5053e085.chunk.js.map